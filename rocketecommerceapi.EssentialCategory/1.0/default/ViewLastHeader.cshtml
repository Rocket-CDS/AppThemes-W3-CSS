@inherits RocketEcommerceAPI.Components.RocketEcommerceAPITokens<Simplisity.SimplisityRazor>
@using DNNrocketAPI;
@using Simplisity;
@using RocketEcommerceAPI.Components;
@using DNNrocketAPI.Components;
@using RocketPortal.Components;

@{ 

    var productData = (ProductLimpet)Model.GetDataObject("productdata");
    var productDataList = (ProductLimpetList)Model.GetDataObject("productlist");
    var companyData = (CompanyLimpet)Model.GetDataObject("companydata"); ;
    var cartData = (CartLimpet)Model.GetDataObject("cartdata");
    var sessionParams = (SessionParams)Model.SessionParamsData;
    var portalShop = (PortalShopLimpet)Model.GetDataObject("portalshop");
    var portalData = (PortalLimpet)Model.GetDataObject("portaldata");
    var appTheme = (AppThemeLimpet)Model.GetDataObject("appthemeview");
    var appThemeDefault = (AppThemeLimpet)Model.GetDataObject("appthemedefault");
    var categoryDataList = (CategoryLimpetList)Model.GetDataObject("categorylist");
    var moduleSettings = (ModuleContentLimpet)Model.GetDataObject("modulesettings");
    var categoryData = (CategoryLimpet)Model.GetDataObject("categorydata");
}
   
@if (productData != null && productData.Exists)
{
    <meta name="keywords" content="@productData.Keywords.Replace("\"","")">
    var productImg = "";
    var img = productData.GetImage(0);
    var dictParams = new Dictionary<string, string>();
    dictParams.Add("pid", productData.ProductId.ToString());

    if (img != null)
{
    productImg = img.RelPath;
} 
<!-- JSON-LD markup generated by Google's structured data markup help tool -->
                <script type="application/ld+json">
        {
        "@@context" : "http://schema.org",
        "@@type" : "Product",
        "name" : "@(productData.Name.Replace("\"", ""))",
        "image" : "@(portalData.EngineUrlWithProtocol)@(productImg)",
        "description" : "@(productData.Summary.Replace("\"", ""))",
        "url" : "@DNNrocketUtils.NavigateURL(moduleSettings.DetailPageTabId(), dictParams, productData.Name),
        "brand" : {
        "@@type" : "Brand",
        "name" : "@(productData.Brand.Replace("\"", ""))"
        },
        "offers" : {
        "@@type" : "Offer",
        "price" : "@(productData.BestPriceDisplay(sessionParams.CultureCode))",
        "priceCurrency": "@portalShop.CurrencyCode"
        }
        }
                </script>
}

@if (DNNrocketUtils.GetLanguageCode(sessionParams.CultureCode) != "en")
{
<script type="text/javascript" src="@(sessionParams.EngineURL)@DNNrocketUtils.AppendFileModifiedDate("/DesktopModules/DNNrocket/js/localization/messages_" + DNNrocketUtils.GetCurrentLanguageCode() + ".js")"></script>
}
